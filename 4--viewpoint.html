<!doctype html>
<html>
<head>
   <title>4 - ViewPoint</title>
   <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no,user-scalable=no,maximum-scale=1">
   <script src="bower_components/aframe/dist/aframe-v0.2.0.min.js"></script>
   <!--
   <script src="https://aframe.io/releases/latest/aframe.min.js"></script>
 -->
</head>
<body>
   <!--
   Credits
   360 Photo from: https://www.flickr.com/photos/bhalash/4156765224/
   Yousif: http://www.immediateentourage.com/muslim-man-2/
   Ann: http://www.immediateentourage.com/girl-in-a-striped-shirt/
   -->

   <a-scene id="main-scene" fog="type: exponential; color: #111; density:.05">

      <!-- block showing scene until these assets are loaded -->
      <a-assets>
         <img src="assets/4/Headline%20-%20Wraparound%20wall2.png">
         <img src="assets/4/Headline%20-%20Wraparound%20wall3.png">
         <img src="assets/4/Headline%20-%20Wraparound%20wall4.png">
         <img src="assets/4/Publisher%20-%20Wraparound%20wall.png">
         <img src="assets/4/Welcome_Left%20Wall_Display%202.jpg">
         <img src="assets/4/Welcome_Left%20Wall_Display%203.jpg">
         <img src="assets/4/Welcome_Left%20Wall_Display%204.jpg">
         <img src="assets/4/interview-right-active@2x.jpg">
         <img src="assets/4/welcome_back2.png">
      </a-assets>

      <!-- Global Settings -->
      <a-sky color="#111"></a-sky>
      <a-light type="ambient" color="#fff"></a-light>
      <a-cube color="#333" position="0 -.26 0" scale="100 .5 100"></a-cube>
      <a-image height="26" width="33" position="10 0 -9.5" rotation="-90 90 0" src="assets/4/floor-plan.png"></a-image>

      <!-- Human Camera -->
      <a-entity position="0 0 0">
         <a-entity position="0 1.6 4">
            <a-camera id="human-camera" wasd-controls-enabled="true" look-controls-enabled="true" active="true">
               <a-entity cursor="fuse: false; maxDistance: 30; timeout: 500"
                  position="0 0 -1"
                  geometry="primitive: ring"
                  scale=".01 .01 .01"
                  material="color: white; shader: flat">
               </a-entity>
            </a-camera>
         </a-entity>
      </a-entity>

      <!-- God Camera -->
      <a-entity position="0 15 -7" rotation="-60 -60 0">
         <a-camera id="god-camera" wasd-controls-enabled="true" look-controls-enabled="true" active="false">

            <a-entity cursor="fuse: true; maxDistance: 30; timeout: 500"
               position="0 0 -1"
               geometry="primitive: ring"
               scale=".01 .01 .01"
               material="color: white; shader: flat">
            </a-entity>
         </a-camera>
      </a-entity>

      <!-- Room: Welcome -->
      <a-entity position="1.5 0 2.5" rotation="0 -90 0" visible="true">
         <!-- Left -->
         <a-plane height="4" width="9" position="-4.5 2 0" rotation="0 90 0" src="assets/4/WelcomeRoom_FINAL.png"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="9" position="0 2 -4.5" src="assets/4/welcome_back.png" data-alt-src="assets/4/welcome_back2.png"></a-plane>
         <!-- Right -->
         <!-- <a-plane height="4" width="9" position="4.5 2 0" rotation="0 -90 0" src="assets/4/white.png"></a-plane> -->
         <!-- Front -->
         <!-- <a-plane height="4" width="9" position="0 2 4.5" rotation="0 180 0" src="assets/4/white.png"></a-plane> -->
      </a-entity>

      <!-- Room: Photobooth -->
      <a-entity position="7.5 0 2.5" rotation="0 -90 0" visible="true">
         <!-- Left -->
         <a-plane height="4" width="3" position="-1.5 2 0" rotation="0 90 0" src="assets/4/Welcome_Left%20Wall_Display.jpg" data-alt-src="assets/4/Welcome_Left%20Wall_Display%202.jpg,assets/4/Welcome_Left%20Wall_Display%203.jpg,assets/4/Welcome_Left%20Wall_Display%204.jpg"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="3" position="0 2 -1.5" src="assets/4/Welcome_Back%20Wall_Exit.jpg"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="3" position="1.5 2 0" rotation="0 -90 0" src="assets/4/Welcome_Right%20Wall.jpg"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="3" position="0 2 1.5" rotation="0 180 0" src="assets/4/Welcome_Front%20Wall_Entry.jpg"></a-plane>
      </a-entity>

      <!-- Room: Walkway -->
      <a-entity position="10 0 2.5" rotation="0 -90 0" visible="true">
         <!-- Left -->
         <a-plane height="4" width="2" position="-4.5 2 0" rotation="0 90 0" src="assets/4/walkway-wall-short-door.jpg"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="9" position="0 2 -1" src="assets/4/walkway-wall-long.jpg"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="2" position="4.5 2 0" rotation="0 -90 0" src="assets/4/walkway-wall-short.jpg"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="9" position="0 2 1" rotation="0 180 0" src="assets/4/walkway-wall-long.jpg"></a-plane>
      </a-entity>

      <!-- Room: Story -->
      <a-entity position="4 0 -4" visible="true">
         <!-- Left -->
         <a-plane height="4" width="4" position="-7 2 0" rotation="0 90 0" src="assets/4/Story%20-%20Left.jpg"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="14" position="0 2 -2" src="assets/4/Story%20-%20Back.jpg"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="4" position="7 2 0" rotation="0 -90 0" src="assets/4/Story%20-%20Right.jpg"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="14" position="0 2 2" rotation="0 180 0" src="assets/4/Story%20-%20Front.jpg"></a-plane>

         <!-- Middle Front -->
         <a-plane height="4" width="12" position="1 2 0" src="assets/4/Story%20-%20Center.jpg"></a-plane>
         <!-- Middle Back -->
         <a-plane height="4" width="12" position="1 2 0" rotation="0 180 0" src="assets/4/black.png"></a-plane>
      </a-entity>

      <!-- Room: Interviews -->
      <a-entity position="6 0 -11" visible="true">
         <!-- <a-entity position="0 0 0" light="
            type: spot;
            color: #ggg;
            intensity: 3;
            angle:150">
         </a-entity> -->
         <!-- <a-entity id="river" geometry="primitive: plane" material="color: blue" position="-2 0 -2" sound="src: assets/4/years-5.mp3; autoplay: true"></a-entity> -->
         <!-- <a-plane src="assets/4/2-right@3x.jpg" height="4" width="10" position="4 2 3" rotation="0 0 0" src="assets/4/white.png"></a-plane> -->
         <!-- Walls -->
         <!-- Left -->
         <a-plane height="4" width="10" position="-5 2 0" rotation="0 90 0" src="assets/4/interview-left@2x.jpg"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="10" position="0 2 -5" src="assets/4/interview-back@2x.jpg"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="10" position="5 2 0" rotation="0 -90 0" src="assets/4/interview-right@2x.jpg" data-alt-src="assets/4/interview-right-active@2x.jpg"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="10" position="0 2 5" rotation="0 180 0" src="assets/4/interview-front@2x.jpg"></a-plane>
      </a-entity>

      <!-- Room: Photos -->
      <a-entity position="6 0 -21" visible="true">
         <!-- Left -->
         <a-plane height="4" width="10" position="-5 2 0" rotation="0 90 0" src="assets/4/Photos%20-%20Left%20Wall.jpg"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="10" position="0 2 -5" src="assets/4/Photos%20-%20Rear%20Wall.jpg"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="10" position="5 2 0" rotation="0 -90 0" src="assets/4/Photos%20-%20Right%20Wall.jpg"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="10" position="0 2 5" rotation="0 180 0" src="assets/4/Photos%20-%20Front%20Wall.jpg"></a-plane>
      </a-entity>

      <!-- Room: Authors -->
      <a-entity position="16 0 -21" rotation="0 -90 0" visible="true">
         <!-- Left -->
         <a-plane height="4" width="10" position="-5 2 0" rotation="0 90 0" src="assets/4/author-left@2x.jpg"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="10" position="0 2 -5" src="assets/4/author-back@2x.jpg"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="10" position="5 2 0" rotation="0 -90 0" src="assets/4/author-right@2x.jpg"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="10" position="0 2 5" rotation="0 180 0" src="assets/4/author-front@2x.jpg"></a-plane>
      </a-entity>

      <!-- Room: Walkway 2 -->
      <a-entity position="17 0 -15" rotation="0 180 0" visible="true">
         <!-- Left -->
         <a-plane height="4" width="2" position="-5 2 0" rotation="0 90 0" src="assets/4/walkway-wall-short.jpg"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="10" position="0 2 -1" src="assets/4/walkway-wall-long-doors.jpg"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="2" position="5 2 0" rotation="0 -90 0" src="assets/4/walkway-wall-short.jpg"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="10" position="0 2 1" rotation="0 180 0" src="assets/4/walkway-wall-long-door.jpg"></a-plane>
      </a-entity>

      <!-- Room: Headline -->
      <a-entity position="17 0 -12" rotation="0 180 0" visible="true">
         <!-- Left -->
         <a-plane height="4" width="4" position="-2 2 0" rotation="0 90 0" src="assets/4/white.png"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="4" position="0 2 -2" src="assets/4/white.png"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="4" position="2 2 0" rotation="0 -90 0" src="assets/4/white.png"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="4" position="0 2 2" rotation="0 180 0" src="assets/4/white.png"></a-plane>

         <!-- Cylinder -->
         <a-curvedimage radius="2" theta-length="360" height="4" rotation="0 -90 0" scale="1 1 1" position="0 2 0" src="assets/4/Headline%20-%20Wraparound%20wall.png" data-alt-src="assets/4/Headline%20-%20Wraparound%20wall2.png,assets/4/Headline%20-%20Wraparound%20wall3.png,assets/4/Headline%20-%20Wraparound%20wall4.png,assets/4/Publisher%20-%20Wraparound%20wall.png"></a-curvedimage>
      </a-entity>

      <!-- Room: Analysis -->
      <a-entity position="17 0 -8" rotation="0 180 0" visible="true">
         <!-- Left -->
         <a-plane height="4" width="4" position="-2 2 0" rotation="0 90 0" src="assets/4/Private%20Analysis_Right%20Wall.jpg"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="4" position="0 2 -2" src="assets/4/Private%20Analysis_Back%20Wall_Exit.jpg"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="4" position="2 2 0" rotation="0 -90 0"  src="assets/4/Private%20Analysis_Left%20Wall_Display.jpg"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="4" position="0 2 1.99" rotation="0 180 0" src="assets/4/Private%20Analysis_Front%20Wall_Entry.jpg"></a-plane>
      </a-entity>

      <!-- Room: Exit -->
      <a-entity position="17 0 -1" rotation="0 180 0" visible="true">
         <!-- Left -->
         <a-plane height="4" width="10" position="-5 2 0" rotation="0 90 0" src="assets/4/Public%20Analysis_Left%20Wall_Display%202.jpg"></a-plane>
         <!-- Back -->
         <a-plane height="4" width="10" position="0 2 -5" src="assets/4/Public%20Analysis_Back%20Wall_Display%201.jpg"></a-plane>
         <!-- Right -->
         <a-plane height="4" width="10" position="5 2 0" rotation="0 -90 0" src="assets/4/Public%20Analysis_Right%20Wall_Exit.jpg"></a-plane>
         <!-- Front -->
         <a-plane height="4" width="10" position="0 2 5" rotation="0 180 0" src="assets/4/Public%20Analysis_Front%20Wall_Entry.jpg"></a-plane>
      </a-entity>




      <!-- <a-curvedimage src="assets/img/1-@3x.jpg" radius="2.2" theta-length="360" height="3" rotation="0 210 0" scale="1 1 1" position="0 1.5 3"></a-curvedimage>
      <a-curvedimage src="assets/img/interviewee-people-f@3x.jpg" radius="2" theta-length="360" height="3" rotation="0 210 0" scale="1 1 1" position="0 1.5 3"></a-curvedimage>

      <a-curvedimage src="assets/img/interviewee-panel-question@3x.jpg" radius="2" theta-length="360" height="3" rotation="0 210 0" scale="1 1 1" position="4 1.5 3"></a-curvedimage> -->

   </a-scene>

   <script>
      /*
      *
      * God mode toggle, press 1 to enter human mode, 2 to enter god mode
      *
      */
      document.onkeydown = checkKey;
      var cameramode = "human";
      function humanMode(){
         cameramode = "human";
         document.querySelector('#god-camera').setAttribute("active","false");
         document.querySelector('#human-camera').setAttribute("active","true");
         document.querySelector('#main-scene').setAttribute("fog","density",.05);
      }
      function godMode(){
         cameramode = "god";
         document.querySelector('#god-camera').setAttribute("active","true");
         document.querySelector('#human-camera').setAttribute("active","false");
         document.querySelector('#main-scene').setAttribute("fog","density",.005);
      }
      var animationclickmode = false;
      function checkKey(e) {

         e = e || window.event;
         // toggle god mode
         if(e.keyCode == '71') { // the letter g
            if(cameramode == "god"){
               humanMode();
            } else {
               godMode();
            }
         }
         // toggle click mode
         if(e.keyCode == '67') { // the letter c
            animationclickmode = !animationclickmode;
         }
         // welcome room
          else if (e.keyCode == '49') { // key 1
               document.querySelector('#human-camera').setAttribute("rotation","-2.0626480624709576 -404.393611803335 0");
               document.querySelector('#human-camera').setAttribute("position","-2.2701610252157285 0 2.4709360834056313");
          }
          // presspass room
          else if (e.keyCode == '50') {
               document.querySelector('#human-camera').setAttribute("rotation","-0.3437746770785135 -92.13161345703645 0");
               document.querySelector('#human-camera').setAttribute("position","6.6146990685869 0 -1.7318656030372355");
          }
          // story room
          else if (e.keyCode == '51') {
            humanMode();
            document.querySelector('#human-camera').setAttribute("rotation","0.34377467707852 -0.6875493541569095 0");
            document.querySelector('#human-camera').setAttribute("position","10.055369105611913 0 -6.718526290458131");
          }
          // jump to interview room
         else if (e.keyCode == '52') {
            humanMode();
            document.querySelector('#human-camera').setAttribute("rotation","-6.187944187412869 28.533298197515176 0");
            document.querySelector('#human-camera').setAttribute("position","9.738957843160394 0 -10.163887419790576");
          }
          // jump to photo room
          else if (e.keyCode == '53') {
            humanMode();
            document.querySelector('#human-camera').setAttribute("rotation","-8.25059224988383 -25.668509221860692 0");
            document.querySelector('#human-camera').setAttribute("position","2.526906111888138 0 -20.33886048491035");
          }
          // jump to writers room
         else if (e.keyCode == '54') {
            humanMode();
            document.querySelector('#human-camera').setAttribute("rotation","-1.2605071492877804 -125.47775713365013 0");
            document.querySelector('#human-camera').setAttribute("position","11.53646584872858 0 -29.14691015956221");
          }
          // jump to headline room
         else if (e.keyCode == '55') {
            humanMode();
            document.querySelector('#human-camera').setAttribute("rotation","1.6042818263663143 -268.4880227983038 0");
            document.querySelector('#human-camera').setAttribute("position","17.092953551367632 0 -16.042708445292202");
          }
          // jump to analysis room
         else if (e.keyCode == '56') {
            humanMode();
            document.querySelector('#human-camera').setAttribute("rotation","-2.2918311805232854 181.62762105647093 0");
            document.querySelector('#human-camera').setAttribute("position","16.462211065141506 0 -12.55243682271476");
          }
          // jump to public analysis room
         else if (e.keyCode == '48') {
            humanMode();
            document.querySelector('#human-camera').setAttribute("rotation","-3.2085636527326113 -179.22119831692137 0");
            document.querySelector('#human-camera').setAttribute("position","18.28849168930665 0 -7.979145529918815");
          }

      }

      /*
      *
      * Mechanism for toggling between image sources for an asset.
      * To implement, simply add a comma delimited data-alt-src attribute to any asset, in addition to its src attribute.
      * The image indicated in the src attribute will load into the VR asset first, followed in succession by
      * each data-alt-src image. The images are swapped out on mouseup when the cursor is directed at that asset.
      */
      var assetswithstates = document.querySelectorAll('[data-alt-src]:not([value=""])');
      if(assetswithstates && assetswithstates.length){
         for (var i=0; i<assetswithstates.length; i++) {
            assetswithstates[i].addEventListener('click', function () {
               if(animationclickmode){
                  // get the total number of states, explode the alt-src array string
                  var srcstates = this.getAttribute("data-alt-src").split(",");
                  // add the current src to the end of the array
                  srcstates.push(this.getAttribute("src"));
                  var newsrc = srcstates.shift(); // remove the first element
                  // set the new src, add old source and unused sources back to the alt-src array string
                  this.setAttribute('src', newsrc);
                  this.setAttribute('data-alt-src',srcstates.join());
               }
            });
         };
      }

   </script>
   </body>
</html>
